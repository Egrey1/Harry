from discord.ext import commands, tasks
from discord.utils import find
from discord import Guild
from config import DATABASE_COUNTRIES as DATABASE_PATH
from config import give_country
from sqlite3 import connect as con
from sqlite3 import Row

from re import compile, IGNORECASE

    

class UpdaterCog(commands.Cog):
    def __init__(self, bot):
        self.bot = bot
        self.update_inventories.start()
    
    def cod_unload(self):
        self.update_inventories.cancel()

    # async def find_channel(self, guild: Guild):
    #     try:
    #         mask = '*?/? ????*'
    #         regex = compile(mask, IGNORECASE)
    #         channel = find(lambda c: regex.search(c.name), guild.channels)
    #         if channel:
    #             return channel
    #     except:
    #         try:
    #             mask = '*??/?? ????*'
    #             regex = compile(mask, IGNORECASE)
    #             channel = find(lambda c: regex.search(c.name), guild.channels)
    #             if channel:
    #                 return channel
    #         except:
    #             try:
    #                 mask = '*?/?? ????*'
    #                 regex = compile(mask, IGNORECASE)
    #                 channel = find(lambda c: regex.search(c.name), guild.channels)
    #                 if channel:
    #                     return channel
    #             except:
    #                 channel = guild.get_channel(1345305581560533002) #tech channel in server
    #                 channel.send('Не удалось найти канал для изменения!')
    #                 raise Exception('Channel not found')

    @tasks.loop(hours=1)
    # @tasks.loop(seconds=10) # for test
    async def update_inventories(self):
        pass


    async def send_i_do(self):
        await self.bot.wait_until_ready()
        print('Выполняется')
    @update_inventories.before_loop(send_i_do)
    async def pass_module(self):
        pass
        


        

async def setup(bot):
    await bot.add_cog(UpdaterCog(bot))